<div
  class="page"
  (click)="clickEvent($event)"
  *ngIf="this.$sortedApartments | async as apartments"
>
  @if (apartments.length > 0) {
    <div class="sort-container z100">
      <div class="sort-btn" (click)="SortDropdownOpen()">
        <div
          [ngStyle]="{
            visibility: !this.navigationService.IsSearchFilterOpen()
              ? 'visible'
              : 'hidden',
          }"
        >
          <i #sortDropdown class="material-icons">keyboard_arrow_down</i>
          <span class="result">מיון לפי</span>
          <span class="date"> {{ this.sortTypeChosen }} </span>
        </div>
        @if (this.isSortDropdownOpen) {
          <div class="sort-dropdown">
            <div class="sort-option" id="date" (click)="sortResults('תאריך')">
              <span>
                @if (this.sortTypeChecked[0]) {
                  <img
                    class="svg-icon"
                    src="assets/images/check-orange.svg"
                    alt="check"
                  />
                }
              </span>
              <span class="">תאריך</span>
            </div>
            <div
              id="price-asc"
              class="sort-option"
              (click)="sortResults('מחיר - מהזול ליקר')"
            >
              <span>
                @if (this.sortTypeChecked[1]) {
                  <img
                    class="svg-icon"
                    src="assets/images/check-orange.svg"
                    alt="check"
                  />
                }
              </span>
              <span>מחיר - מהזול ליקר</span>
            </div>
            <div
              id="price-desc"
              class="sort-option"
              (click)="sortResults('מחיר - מהיקר לזול')"
            >
              <span>
                @if (this.sortTypeChecked[2]) {
                  <img
                    class="svg-icon"
                    src="assets/images/check-orange.svg"
                    alt="check"
                  />
                }
              </span>
              <span>מחיר - מהיקר לזול</span>
            </div>
            <div
              id="location"
              class="sort-option"
              (click)="sortResults('קרוב אלי')"
            >
              <span class="transparent-background">
                @if (this.sortTypeChecked[3]) {
                  <img
                    class="svg-icon"
                    src="assets/images/check-orange.svg"
                    alt="check"
                  />
                }
              </span>

              <span>קרוב אלי</span>
            </div>
          </div>
        }
      </div>

      <div class="result">
        <span style="font-size: 18px">{{ apartments.length }}</span>
        <span> תוצאות </span>
      </div>
    </div>

    <div class="result-list">
      <div
        class="container"
        *ngFor="let advertisement of apartments; let i = index"
      >
        <div
          class="like-button"
          (click)="authSerivce.updateAdvertisementToFavorites(advertisement.id)"
        >
          <mat-icon
            *ngIf="this.isFavorite(advertisement.id)"
            aria-hidden="false"
            aria-label="Example home icon"
            fontIcon="favorite"
            class="like-button-selected"
          ></mat-icon>

          <mat-icon
            [ngClass]="{
              'like-button-red-color': hoverIndex === i,
            }"
            *ngIf="!this.isFavorite(advertisement.id)"
            aria-hidden="false"
            aria-label="Example home icon"
            fontIcon="favorite_border"
            (mouseenter)="hoverIndex = i"
            (mouseleave)="hoverIndex = -1"
          ></mat-icon>
        </div>
        <div
          class="advertisement-details"
          (click)="
            this.navigationService.navigateInNewWindow(
              '/advertisement/' + advertisement.id
            )
          "
        >
          <div class="ad-content-text">
            <div class="price-mobile mobile">
              @if (advertisement.price > 0) {
                <span>₪</span> {{ advertisement.price | number }}
              } @else {
                <span class="letter-spacing"> לא צוין מחיר</span>
              }
            </div>
            <div class="title">
              {{ advertisement.street + " " + advertisement.number }}
            </div>

            <div class="list-group-item margin-lef">
              {{ advertisement.assetType }},{{
                " " + advertisement.neighborhood
              }},{{ " " + advertisement.city }}
            </div>

            <div class="list-group-item margin-left">
              <li>{{ advertisement.rooms }} חדרים •</li>
              <li>קומה {{ advertisement.floor }} •</li>
              <li>{{ advertisement.totalSquareMeters }} מ"ר</li>
            </div>
          </div>

          <div class="desktop last-row">
            <div class="tags">
              <div class="price">
                @if (advertisement.price > 0) {
                  <span>₪</span> {{ advertisement.price | number }}
                } @else {
                  <span class="letter-spacing"> לא צוין מחיר</span>
                }
              </div>
            </div>
          </div>
        </div>
        <div class="image">
          @if (advertisement.mainPicture !== "") {
            <img
              routerLink="/advertisement/{{ advertisement.id }}"
              *ngIf="
                advertisement.pictures && advertisement.pictures.length > 0
              "
              [src]="advertisement.mainPicture"
              class="card-img"
              alt="Advertisement Image"
            />
          } @else {
            <img
              id="empty-ad-image"
              routerLink="/advertisement/{{ advertisement.id }}"
              src="assets/images/image_placeholder.svg"
              class="card-img"
              alt="Advertisement Image"
            />
          }
        </div>
      </div>
    </div>
  } @else {
    <div class="not-found column flex-center">
      <img id="no-results-img" src="assets/images/no-results.svg" alt="" />
      <div class="font28 column flex-center gap3 font500 letter-spacing">
        <div>זה לא עניין שבשגרה, אבל מה</div>
        <div>שחיפשת לא נמצא</div>
      </div>
      <div class="font18 column flex-center advise-text letter-spacing">
        <div>ממליצים ליצור התראה, ככה נעדכן אותך ברגע שיעלו</div>
        <div>מודעות נוספות (ועולות פה הרבה)</div>
      </div>
      <div class="alert-btn font500 font18 flex-center">
        <span> יצירת התראה </span>
        <img
          id="bell-img"
          src="assets/images/bell-plus-svgrepo-com.svg"
          alt=""
        />
      </div>
    </div>
  }
</div>
